<!doctype html>
<html lang="en">
<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.4.3/css/ol.css" type="text/css">
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" />
    <style>
        .map {
            height: 400px;
            width: 100%;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.4.3/build/ol.js"></script>
    <title>SensorData Challenge</title>
</head>
<body>
    <h2 class="text-center">OpenLayer Map</h2>
    <div id="map" class="map">
    </div>
    <br/>
    <button onclick="generateMarkers()" class="btn btn-primary">Generate markers</button>
</body>
</html>

<script type="text/javascript">
    var map = new ol.Map({
        target: 'map',
        view: new ol.View({
            center: ol.proj.fromLonLat([0, 0]),
            zoom: 0,
        }),
        layers: [
            new ol.layer.Tile({
                source: new ol.source.OSM()
            })
        ],
    });

    //map.events.register("click", map, function (e) {
    //    var lonlat = map.getLonLatFromPixel(e.xy);
    //    alert("You clicked near " + lonlat.lat + " N, " + +lonlat.lon + " E");
    //});
    
    function generateMarkers() {
        map.getLayers().forEach(function (layer) {
            map.removeLayer(layer);
        });
        var layer = new ol.layer.Vector({
            source: new ol.source.Vector({
                features: [
                    new ol.Feature({
                        geometry: new ol.geom.Point(ol.proj.fromLonLat([getRandomArbitary(-180, 180), getRandomArbitary(-90, 90)]))
                    }),
                    new ol.Feature({
                        geometry: new ol.geom.Point(ol.proj.fromLonLat([getRandomArbitary(-180, 180), getRandomArbitary(-90, 90)]))
                    }),
                    new ol.Feature({
                        geometry: new ol.geom.Point(ol.proj.fromLonLat([getRandomArbitary(-180, 180), getRandomArbitary(-90, 90)]))
                    })
                ]
            })
        });
        map.addLayer(new ol.layer.Tile({
            source: new ol.source.OSM()
        }));
        map.addLayer(layer)
        console.log(map.getLayers());
        //map.getView().setCenter(ol.proj.fromLonLat([lon, lat]));
    }

    function getRandomArbitary(min, max) {
        return Math.random() * (max - min) + min;
    }
</script>